<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Document</title>
    </head>
    <body onload="document.querySelectorAll('input')[0].focus()">

        <style>
            input {
                width: 50px;
                height: 50px;
                font-size: 40px;
                text-align: center;
                margin-bottom: 5px;
                border: 1px solid #dbdbdb;
                font-family: Cambria, Cochin, Georgia, Times, 'Times New Roman', serif;
                background: white;
                transition: background 1s;
            }
        </style>
        <div style="text-align: center;" class="area">
            <input class="input slide" maxlength="1" oninput="validInput(this)">
            <input class="input" maxlength="1" oninput="validInput(this)">
            <input class="input" maxlength="1" oninput="validInput(this)">
            <input class="input" maxlength="1" oninput="validInput(this)">
            <input class="input" maxlength="1" oninput="validInput(this)">
        </div>
        <div style="text-align: center; margin-top: 10px;" class="default">
            <button onclick="retry()">다시하기</button>

        </div>

        <script>
            
            var 답 = '';
            
            function makeAnswer(){
                답 = '';
                var possible = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
                for( var i=0; i < 5; i++ ){
                    답 += possible.charAt(Math.floor(Math.random() * possible.length));
                }
            }

            function retry(){
                makeAnswer();
                init();
            }

            function init(){
                document.querySelectorAll("div:not(.default)").forEach(e => e.remove());
                makeDiv('beforebegin');
                document.querySelectorAll('input')[0].focus()
            }

            function makeDiv(type){
                var template = `<div style="text-align: center;" class="area">
                    <input class="input" maxlength="1" oninput="validInput(this)">
                    <input class="input" maxlength="1" oninput="validInput(this)">
                    <input class="input" maxlength="1" oninput="validInput(this)">
                    <input class="input" maxlength="1" oninput="validInput(this)">
                    <input class="input" maxlength="1" oninput="validInput(this)">
                </div>`;
                document.querySelector('div').insertAdjacentHTML(type, template);
            }
            
            function execFn(){
                
                var bingo = 0;
                var input = document.querySelectorAll('.input');
                
                for(let i=0; i < 5; i++){
                    if(input[i].value == 답[i]){
                        input[i].style.background = '#09ff00';
                        bingo++;
                    }else if(답.includes(input[i].value)){
                        input[i].style.background = 'yellow';
                    }else {
                        input[i].style.background = 'lightgrey';
                    }

                    input[i].classList.remove('input');
                }

                if(bingo == 5 || document.querySelectorAll('.area').length == 6){
                    var template = "";
                    if(bingo == 5){
                        template = `<div style="text-align: center;font-size:25px;">
                            축하합니다. 성공했습니다.
                        </div>`;
                    }else {
                        template = `<div style="text-align: center;font-size:25px;">
                            실패했습니다.
                        </div>`;
                    }
                    document.querySelector('div').insertAdjacentHTML('beforeend', template);
                    document.querySelector('button').focus();
                }else {
                    setTimeout(function(){
                        makeDiv('beforeend');
                
                        if(document.querySelector('div:last-child')){
                            document.querySelector('div:last-child').querySelector('input').focus();
                        } 
                    }, 1000);
                    
                }
                    
            };

            function validInput(e){
                e.value = e.value.replace(/[^A-Z]/ig, '').toUpperCase();
                
                if(e.value){
                    if(e.nextElementSibling){
                        e.nextElementSibling.focus();

                    }else {
                        execFn();
                    }
                }
            }

            makeAnswer();
        </script>

    </body>
</html>